--1)
SELECT COL.Apellido, COL.Nombre, COUNT(PR.ID) FROM COLABORADORES AS COL
INNER JOIN Colaboraciones AS COLA ON COLA.IDColaborador=COL.ID
INNER JOIN TAREAS AS T ON COLA.IDTAREA= T.ID
INNER JOIN Modulos AS MO ON MO.ID= T.IDModulo
INNER JOIN Proyectos AS PR ON MO.IDProyecto= PR.ID
GROUP BY COL.Apellido, COL.Nombre
GO

SELECT COL.Apellido, COL.Nombre, COUNT(PR.ID) FROM Proyectos AS PR
INNER JOIN Modulos AS MO ON MO.IDProyecto = PR.ID
INNER JOIN Tareas AS T ON T.IDModulo= MO.ID
INNER JOIN Colaboraciones AS COLA ON COLA.IDTarea=T.ID
INNER JOIN Colaboradores AS COL ON COLA.IDColaborador= COL.ID
GROUP BY COL.Apellido, COL.Nombre
GO

--2)
SELECT CL.RazonSocial , MAX(MO.CostoEstimado) FROM CLIENTES AS CL
INNER JOIN Proyectos AS PR ON PR.IDCliente = CL.ID
INNER JOIN Modulos AS MO ON PR.ID = MO.IDProyecto
GROUP BY CL.RazonSocial
GO

--3)
SELECT TT.Nombre FROM TiposTarea AS TT
WHERE (
SELECT COUNT(DISTINCT COL.ID) FROM COLABORADORES AS COL
INNER JOIN Colaboraciones AS CO ON COL.ID= CO.IDColaborador
INNER JOIN Tareas AS T ON T.ID = CO.IDTarea
INNER JOIN TiposTarea AS TT2 ON TT2.ID= T.IDTipo
WHERE YEAR(T.FechaInicio) =2020 AND TT2.ID=TT.ID
)>10
GO

--4)
SELECT CL.RazonSocial, AVG(PR.COSTOESTIMADO) FROM CLIENTES AS CL
INNER JOIN Proyectos AS PR ON PR.IDCliente= CL.ID
GROUP BY CL.RazonSocial
GO

--5)
SELECT TT.Nombre FROM TiposTarea AS TT
WHERE (
SELECT AVG(COLA.ID) FROM Colaboradores AS  COLA
INNER JOIN Colaboraciones AS COL ON COL.IDCOLABORADOR= COLA.ID
INNER JOIN TAREAS AS T ON T.ID= COL.IDTarea
INNER JOIN TiposTarea AS TT2 ON TT2.ID =T.IDTIPO
WHERE COLA.TIPO = 'E' AND TT2.ID=TT.ID
)>(SELECT AVG(COLA.ID) FROM Colaboradores AS  COLA
INNER JOIN Colaboraciones AS COL ON COL.IDCOLABORADOR= COLA.ID
INNER JOIN TAREAS AS T ON T.ID= COL.IDTarea
INNER JOIN TiposTarea AS TT2 ON TT2.ID =T.IDTIPO
WHERE COLA.TIPO = 'I' AND TT2.ID=TT.ID)
go

--6)

SELECT PR.Nombre, COUNT (*) CANTIDAD FROM Colaboradores AS COLA
INNER JOIN Colaboraciones AS COL ON COL.IDColaborador= COLA.ID
INNER JOIN Tareas AS T ON T.ID= COL.IDTarea
INNER JOIN Modulos AS MO ON MO.ID= T.IDModulo
INNER JOIN PROYECTOS AS PR ON PR.ID= MO.IDProyecto
GROUP BY PR.Nombre
